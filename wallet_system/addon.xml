<?xml version="1.0"?>
<addon scheme="4.0">
    <id>wallet_system</id>
    <name>Wallet_system</name>
    <version>5.0</version>
    <priority>222</priority>
    <position>10</position>
    <status>active</status>
	<has_icon>Y</has_icon>
	<supplier>Webkul Software Pvt. Ltd.</supplier>
	<supplier_link>https://store.webkul.com/CS-Cart.html</supplier_link>
    <default_language>en</default_language>
    <auto_install>MULTIVENDOR,ULTIMATE</auto_install>    
    <settings edition_type="ROOT,ULT:VENDOR">
        <sections>
          <section id="general">
            <items>
                <item id="setting_general">
                    <type>template</type>
                    <default_value>wallet_system_general_setting.tpl</default_value>
                </item>
            </items>
          </section>
        </sections>
    </settings> 
    <autoload>
        <psr4 prefix="Tygh\Addons\WalletSystem\">src</psr4>
    </autoload>
    <bootstrap>\Tygh\Addons\WalletSystem\Bootstrap</bootstrap>
    <installer>\Tygh\Addons\WalletSystem\Installer</installer>
    <queries>
        <item for="install">DROP TABLE IF EXISTS ?:wallet_cash;</item>
        <item for="install">DROP TABLE IF EXISTS ?:wallet_debit_log;</item>
        <item for="install">DROP TABLE IF EXISTS ?:wallet_credit_log;</item>
        <item for="install">DROP TABLE IF EXISTS ?:wallet_offline_payment;</item>
        <item>

            CREATE TABLE IF NOT EXISTS `?:wallet_cash` (
              `wallet_id` mediumint(8) NOT NULL AUTO_INCREMENT,
              `user_id` mediumint(8) NOT NULL,
              `total_cash` decimal(10,2) NOT NULL,
              `company_id` mediumint(8) NOT NULL,
              PRIMARY KEY (`wallet_id`)
            ) ENGINE=MyISAM  DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;
            
        </item>
        <item>

            CREATE TABLE IF NOT EXISTS `?:wallet_credit_log` (
              `credit_id` mediumint(8) NOT NULL AUTO_INCREMENT,
              `source` varchar(100) NOT NULL,
              `source_id` mediumint(8) NOT NULL,
              `credit_amount` decimal(10,2) NOT NULL,
              `total_amount` decimal(10,2) NOT NULL,
              `wallet_id` mediumint(8) NOT NULL,
              `timestamp` varchar(20) NOT NULL,
              `refund_reason` text NOT NULL ,
              `extra_info` varchar(999) NOT NULL,
              `company_id` mediumint(8) NOT NULL,
              PRIMARY KEY (`credit_id`)
            ) ENGINE=MyISAM  DEFAULT CHARSET=utf8 COLLATE utf8_general_ci AUTO_INCREMENT=1 ;

        </item>
        <item>

            CREATE TABLE IF NOT EXISTS `?:wallet_debit_log` (
              `debit_id` mediumint(8) NOT NULL AUTO_INCREMENT,
              `wallet_id` mediumint(8) NOT NULL,
              `debit_amount` decimal(10,2) NOT NULL,
              `remain_amount` decimal(10,2) NOT NULL,
              `order_id` mediumint(8) NOT NULL,
              `timestamp` varchar(20) NOT NULL,
              `area` char(1) NOT NULL,
               `debit_reason` text DEFAULT '',
               `source` text DEFAULT '',
               `extra_info` varchar(999) NOT NULL,
               `company_id` mediumint(8) NOT NULL,
              PRIMARY KEY (`debit_id`)
            ) ENGINE=MyISAM  DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;

        </item>

        <item>
          CREATE TABLE IF NOT EXISTS `?:wallet_offline_payment` (
            `id` mediumint(8) NOT NULL AUTO_INCREMENT,
            `wallet_id` mediumint(8) NOT NULL,
            `order_id` mediumint(8) NOT NULL,
            `status` char(3) NOT NULL DEFAULT 'no',
            PRIMARY KEY (`id`)
          ) ENGINE=MyISAM  DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;
        </item>
        <item>
            CREATE TABLE IF NOT EXISTS `?:wallet_transaction` (
              `transaction_id` int(11) NOT NULL AUTO_INCREMENT,
              `credit_id` int(11) NOT NULL,
              `debit_id` int(11) NOT NULL,
              `wallet_id` int(11) NOT NULL,
              `timestamp` varchar(10) NOT NULL,
              PRIMARY KEY (`transaction_id`)
            ) ENGINE=MyISAM DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;
        </item>

        <item>
            CREATE TABLE IF NOT EXISTS `?:customer_banks` (
              `id` int(11) NOT NULL AUTO_INCREMENT,
              `user_id` int(11) NOT NULL,
              `ifsc_code` varchar(30) NOT NULL,
              `account_number` varchar(30) NOT NULL,
              `holder_name` varchar(50) NOT NULL,
              `bank_name` varchar(255) NOT NULL,
              PRIMARY KEY (`id`)
            ) ENGINE=MyISAM DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;
        </item>

        <item>
            CREATE TABLE IF NOT EXISTS `?:wallet_bank_transfer` (
              `id` int(11) NOT NULL AUTO_INCREMENT,
              `user_id` int(11) NOT NULL,
              `bank_id` int(11) NOT NULL,
              `transfer_amount` int(30) NOT NULL,
              `transaction_id` varchar(255) NOT NULL,
              `pair_id` varchar(255) NOT NULL,
              `status` varchar(50) NOT NULL,              
              PRIMARY KEY (`id`)
            ) ENGINE=MyISAM DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;
        </item>

         <item>ALTER TABLE `?:orders` ADD `wallet_refunded_amount` decimal(11,2) NOT NULL DEFAULT '0.00'</item>
         <item>ALTER TABLE `?:orders` ADD `pay_by_wallet_amount` decimal(11,2) NOT NULL DEFAULT '0.00'</item>
        <item for="uninstall">ALTER TABLE  `?:orders` DROP `wallet_refunded_amount`</item>
        <item for="uninstall">ALTER TABLE  `?:orders` DROP `pay_by_wallet_amount`</item>
        
        <item for="uninstall">DROP TABLE IF EXISTS ?:wallet_cash;</item>
        <item for="uninstall">DROP TABLE IF EXISTS ?:wallet_transaction;</item>
        <item for="uninstall">DROP TABLE IF EXISTS ?:wallet_credit_log;</item>
        <item for="uninstall">DROP TABLE IF EXISTS ?:wallet_debit_log;</item>
        <item for="uninstall">DROP TABLE IF EXISTS ?:wallet_offline_payment;</item>
        <item for="uninstall">DROP TABLE IF EXISTS ?:customer_banks;</item>
        <item for="uninstall">DROP TABLE IF EXISTS ?:wallet_bank_transfer;</item>
    </queries>
    <email_templates>
        <templates>
            <item>
                <code><![CDATA[wallet_credit]]></code>
                <area><![CDATA[C]]></area>
                <status><![CDATA[A]]></status>
                <default_subject><![CDATA[{{ company_name }}: {{ __("wallet_credit_details") }}]]></default_subject>
                <default_template><![CDATA[{{ snippet("header") }}      
                    {{ __("dear") }} {{ wallet_data.user_name }},<br /><br />

                    {{ __("your_wallet_credited_with_amount") }} {{ wallet_data.amount }} <br /><br />
                    {% if wallet_data.source == 'refund_rma' %}

                    {{ __("regardeing_return_request_no") }} {{ wallet_data.source_id }}<br />   
                    <strong>{{ __("credit_source") }}</strong> : {{ __("refund") }}<br />
                    {% endif %}
                    {% if wallet_data.source == 'recharge' %}

                    {{ __("regardeing_order_no") }} {{ wallet_data.source_id }}<br />   
                    <strong>{{ __("credit_source") }}</strong> : {{ __("recharge") }}<br />
                    {% endif %}
                    <strong>{{ __("credit_wallet_amount") }}</strong> : {{ wallet_data.amount }}<br />
                    <strong>{{ __("total_wallet_amount") }}</strong> : {{ wallet_data.total_cash }}<br />

                    {{ snippet("footer") }}]]>
                </default_template>
                <addon><![CDATA[wallet_system]]></addon>
            </item>
       
            <item>
                <code><![CDATA[wallet_debit]]></code>
                <area><![CDATA[C]]></area>
                <status><![CDATA[A]]></status>
                <default_subject><![CDATA[{{ company_name }}: {{ __("wallet_debit_details") }}]]></default_subject>
                <default_template><![CDATA[{{ snippet("header") }}
                    {{ __("dear") }} {{ wallet_data.user_name }},<br /><br />

                    {{ __("your_wallet_debited_with_amount") }} {{ wallet_data.amount }}<br /><br />
                    {% if wallet_data.order_id %}

                    {{ __("regardeing_order_no") }} {{ wallet_data.order_id }}<br />   

                    {% endif %}
                    <strong>{{ __("debit_wallet_amount") }}</strong> : {{ wallet_data.amount }} <br />
                    <strong>{{ __("total_wallet_amount") }}</strong> : {{ wallet_data.total_cash }} <br />
                    {{ snippet("footer") }}]]>
                </default_template>
                <addon><![CDATA[wallet_system]]></addon>
            </item>

            <item>
                <code><![CDATA[wallet_recharge_email_template_for_customer]]></code>
                <area><![CDATA[C]]></area>
                <status><![CDATA[A]]></status>
                <default_subject><![CDATA[{{ company_name }}: {{ __("wallet_recharge") }}]]></default_subject>
                <default_template><![CDATA[{{ snippet("header") }}
					
                    {{ __("template.wallet_recharge_email_template_for_customer", {"[user_name]": wallet_data.user_name, "[order_number]": wallet_data.order_number, "[amount]": wallet_data.amount, "[total_cash]": wallet_data.total_cash}) }}
                    
					{{ snippet("footer") }}]]>
				</default_template>
                <addon><![CDATA[wallet_system]]></addon>
            </item>


            <item>
                <code><![CDATA[wallet_recharge_email_template_for_admin]]></code>
                <area><![CDATA[C]]></area>
                <status><![CDATA[A]]></status>
                <default_subject><![CDATA[{{ company_name }}: {{ __("wallet_recharge") }}]]></default_subject>
                <default_template><![CDATA[{{ snippet("header") }}
					
                    {{ __("template.wallet_recharge_email_template_for_admin", {"[name]": 'name', "[order_number]": wallet_data.order_number, "[amount]": wallet_data.amount, "[total_cash]": wallet_data.total_cash}) }}
                    
					{{ snippet("footer") }}]]>
				</default_template>
                <addon><![CDATA[wallet_system]]></addon>
            </item>


            <item>
                <code><![CDATA[wallet_amount_used_email_template_for_customer]]></code>
                <area><![CDATA[C]]></area>
                <status><![CDATA[A]]></status>
                <default_subject><![CDATA[{{ company_name }}: {{ __("wallet_amount_used") }}]]></default_subject>
                <default_template><![CDATA[{{ snippet("header") }}
					
                    {{ __("template.wallet_amount_used_email_template_for_customer", {"[user_name]": wallet_data.user_name, "[order_number]": wallet_data.order_number, "[amount]": wallet_data.amount, "[total_cash]": wallet_data.total_cash}) }}
                    
					{{ snippet("footer") }}]]>
				</default_template>
                <addon><![CDATA[wallet_system]]></addon>
            </item>


            <item>
                <code><![CDATA[wallet_amount_used_email_template_for_admin]]></code>
                <area><![CDATA[C]]></area>
                <status><![CDATA[A]]></status>
                <default_subject><![CDATA[{{ company_name }}: {{ __("wallet_amount_used") }}]]></default_subject>
                <default_template><![CDATA[{{ snippet("header") }}
					
                    {{ __("template.wallet_amount_used_email_template_for_admin", {"[name]": 'name', "[order_number]": wallet_data.order_number, "[amount]": wallet_data.amount, "[total_cash]": wallet_data.total_cash}) }}
                    
					{{ snippet("footer") }}]]>
				</default_template>
                <addon><![CDATA[wallet_system]]></addon>
            </item>

            <item>
                <code><![CDATA[wallet_cashback_amount_email_template_for_customer]]></code>
                <area><![CDATA[C]]></area>
                <status><![CDATA[A]]></status>
                <default_subject><![CDATA[{{ company_name }}: {{ __("cashback_amount") }}]]></default_subject>
                <default_template><![CDATA[{{ snippet("header") }}
					
                    {{ __("template.wallet_cashback_amount_email_template_for_customer", {"[user_name]": wallet_data.user_name, "[amount]": wallet_data.amount, "[total_cash]": wallet_data.total_cash}) }}
                    
					{{ snippet("footer") }}]]>
				</default_template>
                <addon><![CDATA[wallet_system]]></addon>
            </item>

            <item>
                <code><![CDATA[wallet_cashback_amount_email_template_for_admin]]></code>
                <area><![CDATA[C]]></area>
                <status><![CDATA[A]]></status>
                <default_subject><![CDATA[{{ company_name }}: {{ __("cashback_amount") }}]]></default_subject>
                <default_template><![CDATA[{{ snippet("header") }}
					
                    {{ __("template.wallet_cashback_amount_email_template_for_admin", {"[name]": 'name', "[amount]": wallet_data.amount, "[total_cash]": wallet_data.total_cash}) }}
                    
					{{ snippet("footer") }}]]>
				</default_template>
                <addon><![CDATA[wallet_system]]></addon>
            </item>


            <item>
                <code><![CDATA[wallet_amount_refund_email_template_for_customer]]></code>
                <area><![CDATA[C]]></area>
                <status><![CDATA[A]]></status>
                <default_subject><![CDATA[{{ company_name }}: {{ __("amount_refund") }}]]></default_subject>
                <default_template><![CDATA[{{ snippet("header") }}
					
                    {{ __("template.wallet_amount_refund_email_template_for_customer", {"[user_name]": wallet_data.user_name, "[amount]": wallet_data.amount, "[total_cash]": wallet_data.total_cash}) }}
                    
					{{ snippet("footer") }}]]>
				</default_template>
                <addon><![CDATA[wallet_system]]></addon>
            </item>


            <item>
                <code><![CDATA[wallet_amount_refund_email_template_for_admin]]></code>
                <area><![CDATA[C]]></area>
                <status><![CDATA[A]]></status>
                <default_subject><![CDATA[{{ company_name }}: {{ __("amount_refund") }}]]></default_subject>
                <default_template><![CDATA[{{ snippet("header") }}
					
                    {{ __("template.wallet_amount_refund_email_template_for_admin", {"[name]": 'name', "[amount]": wallet_data.amount, "[total_cash]": wallet_data.total_cash}) }}
                    
					{{ snippet("footer") }}]]>
				</default_template>
                <addon><![CDATA[wallet_system]]></addon>
            </item>


            <item>
                <code><![CDATA[wallet_amount_order_refund_email_template_for_customer]]></code>
                <area><![CDATA[C]]></area>
                <status><![CDATA[A]]></status>
                <default_subject><![CDATA[{{ company_name }}: {{ __("order_refund") }}]]></default_subject>
                <default_template><![CDATA[{{ snippet("header") }}
					
                    {{ __("template.wallet_amount_order_refund_email_template_for_customer", {"[user_name]": wallet_data.user_name, "[order_number]": wallet_data.order_number, "[amount]": wallet_data.amount, "[total_cash]": wallet_data.total_cash}) }}
                    
					{{ snippet("footer") }}]]>
				</default_template>
                <addon><![CDATA[wallet_system]]></addon>
            </item>


            <item>
                <code><![CDATA[wallet_amount_order_refund_email_template_for_admin]]></code>
                <area><![CDATA[C]]></area>
                <status><![CDATA[A]]></status>
                <default_subject><![CDATA[{{ company_name }}: {{ __("order_refund") }}]]></default_subject>
                <default_template><![CDATA[{{ snippet("header") }}
					
                    {{ __("template.wallet_amount_order_refund_email_template_for_admin", {"[name]": 'name', "[order_number]": wallet_data.order_number, "[amount]": wallet_data.amount, "[total_cash]": wallet_data.total_cash}) }}
                    
					{{ snippet("footer") }}]]>
				</default_template>
                <addon><![CDATA[wallet_system]]></addon>
            </item>

            <item>
                <code><![CDATA[admin_credit_amount_email_template_for_customer]]></code>
                <area><![CDATA[C]]></area>
                <status><![CDATA[A]]></status>
                <default_subject><![CDATA[{{ company_name }}: {{ __("credit_by_admin") }}]]></default_subject>
                <default_template><![CDATA[{{ snippet("header") }}

                    {{ __("template.admin_credit_amount_email_template_for_customer", {"[user_name]": wallet_data.user_name, "[amount]": wallet_data.amount, "[total_cash]": wallet_data.total_cash} ) }}
                    
					{{ snippet("footer") }}]]>
				</default_template>
                <addon><![CDATA[wallet_system]]></addon>
            </item>

            <item>
                <code><![CDATA[admin_credit_amount_email_template_for_admin]]></code>
                <area><![CDATA[C]]></area>
                <status><![CDATA[A]]></status>
                <default_subject><![CDATA[{{ company_name }}: {{ __("credit_by_admin") }}]]></default_subject>
                <default_template><![CDATA[{{ snippet("header") }}
					
                    {{ __("template.admin_credit_amount_email_template_for_admin", {"[name]": 'name', "[amount]": wallet_data.amount, "[total_cash]": wallet_data.total_cash}) }}
                    
					{{ snippet("footer") }}]]>
				</default_template>
                <addon><![CDATA[wallet_system]]></addon>
            </item>

            <item>
                <code><![CDATA[admin_debit_amount_email_template_for_customer]]></code>
                <area><![CDATA[C]]></area>
                <status><![CDATA[A]]></status>
                <default_subject><![CDATA[{{ company_name }}: {{ __("debit_by_admin") }}]]></default_subject>
                <default_template><![CDATA[{{ snippet("header") }}

                    {{ __("template.admin_debit_amount_email_template_for_customer", {"[user_name]": wallet_data.user_name, "[amount]": wallet_data.amount, "[total_cash]": wallet_data.total_cash} ) }}
                    
					{{ snippet("footer") }}]]>
				</default_template>
                <addon><![CDATA[wallet_system]]></addon>
            </item>

            <item>
                <code><![CDATA[admin_debit_amount_email_template_for_admin]]></code>
                <area><![CDATA[C]]></area>
                <status><![CDATA[A]]></status>
                <default_subject><![CDATA[{{ company_name }}: {{ __("debit_by_admin") }}]]></default_subject>
                <default_template><![CDATA[{{ snippet("header") }}
					
                    {{ __("template.admin_debit_amount_email_template_for_admin", {"[name]": 'name', "[amount]": wallet_data.amount, "[total_cash]": wallet_data.total_cash}) }}
                    
					{{ snippet("footer") }}]]>
				</default_template>
                <addon><![CDATA[wallet_system]]></addon>
            </item>


        </templates>
    </email_templates>
<marketplace_product_id>828</marketplace_product_id><marketplace_license_number>MP-531Q-8AY6-13Q7-X0EH</marketplace_license_number></addon>
